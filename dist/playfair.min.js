/*! Playfair.js - v0.1.0-dev - 2013-09-28 */

(function(t){"use strict";var s=t.google||{},n=t.PF||{};t.PF=n,n.defaults=n.defaults||{},n.defaults.chs="300x200",n.opts=n.opts||{},n.opts.chd=function(t){var s,e,r=/^([tse]):(.+)$/;return(s=r.exec(t))?("t"===s[1]?e=function(t){var s,n,e,r,l,i,o,u,a,h;for(i=[],o=t.split("|"),s=0,n=o.length;n>s;s++){for(l=[],u=o[s],h=u.split(","),e=0,r=h.length;r>e;e++)a=h[e],"_"===a?a=null:(a=parseFloat(a),isNaN(a)&&(a=null)),l.push(a);i.push(l)}return i}(s[2]):"s"===s[1]?e=function(t){var s,n,e,r,l,i,o,u,a,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(i=[],o=t.split(","),s=0,n=o.length;n>s;s++){for(l=[],u=o[s],e=0,r=u.length;r>e;e++)a=u.substring(e,e+1),"_"===a?a=null:(a=h.indexOf(a),-1===a&&(a=null)),l.push(a);i.push(l)}return i}(s[2]):"e"===s[1]&&(e=function(t){var s,n,e,r,l,i,o,u,a,h,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-.";for(u=[],a=t.split(","),n=0,e=a.length;e>n;n++){for(o=[],h=a[n],r=0,l=h.length;l>r;r+=2)s=h.substring(r,r+1),i=h.substring(r+1,r+2),"_"===s||"_"===i?c=null:(s=d.indexOf(s),i=d.indexOf(i),c=-1===s||-1===i?null:64*s+i),o.push(c);u.push(o)}return u}(s[2])),e):(n.utils.logError("No format specified for chd (data). Aborting."),void 0)},n.opts.chdl=function(t){return(t||"").split("|")},n.opts.chl=n.opts.chdl,n.opts.chs=function(t){var s,e=/^(\d+)x(\d+)$/;return null==t&&(n.utils.logError("chs (size) not specified. Using default."),t=n.defaults.chs),s=e.exec(t),s||(n.utils.logError("chs (size) formatted incorrectly. Using default."),s=e.exec(n.defaults.chs)),{height:parseInt(s[2],10),width:parseInt(s[1],10)}},n.opts.cht=function(t){var n,e={};switch(t){case"p3":e.is3D=!0;case"p":n=s.visualization.PieChart}return{chartClass:n,options:e}},n.utils=n.utils||{},n.utils.buildTable=function(t,n){var e,r,l,i,o,u,a=[],h=0;for(u=new s.visualization.DataTable,u.addColumn("string"),e=0,r=n.length;r>e;e++)u.addColumn("number"),o=n[e],a.push(o.length);for(h=Math.max.apply(null,a),l=0;h>l;l++){for(i=[t[l]],e=0,r=n.length;r>e;e++)o=n[e],i.push(o[l]);u.addRow(i)}return u},n.utils.logError=function(s,n){n=n!==void 0?n:t.document.getElementById("playfair-errors");var e=t.document.createDocumentFragment(),r=t.document.createElement("p");r.textContent=s,e.appendChild(r),n.appendChild(e)},n.utils.parseHash=function(t){var s,n,e,r,l,i={};for(t="#"===t.substring(0,1)?t.substring(1):t,l=t.split("&"),s=0,n=l.length;n>s;s++)r=l[s],e=r.split("="),i[e[0]]=e[1];return i},n.init=function(e,r){var l=n.utils.parseHash(e);s.load("visualization","1.0",{packages:["corechart"]}),s.setOnLoadCallback(function(){var s,e,i=t.document.getElementById(r),o=n.opts.cht(l.cht),u=n.opts.chs(l.chs),a={},h=n.utils.buildTable(n.opts.chdl(l.chdl||l.chl),n.opts.chd(l.chd));for(e in o.options)o.options.hasOwnProperty(e)&&(a[e]=o.options[e]);a.height=u.height,a.width=u.width,s=new o.chartClass(i),s.draw(h,a)})}})(this);