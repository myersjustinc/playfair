/*! Playfair.js - v0.1.0-dev - 2013-09-28 */

(function(t){"use strict";function n(){n.history=n.history||[],n.history.push(arguments),t.console&&t.console.log(Array.prototype.slice.call(arguments))}var s=t.google||{},e=t.PF||{};t.PF=e,e.defaults=e.defaults||{},e.defaults.chs="300x200",e.opts=e.opts||{},e.opts.chd=function(t){var n,s,l=/^([tse]):(.+)$/;return(n=l.exec(t))?("t"===n[1]?s=function(t){var n,s,e,l,r,o,u,i,a,c;for(o=[],u=t.split("|"),n=0,s=u.length;s>n;n++){for(r=[],i=u[n],c=i.split(","),e=0,l=c.length;l>e;e++)a=c[e],"_"===a?a=null:(a=parseFloat(a),isNaN(a)&&(a=null)),r.push(a);o.push(r)}return o}(n[2]):"s"===n[1]?s=function(t){var n,s,e,l,r,o,u,i,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(o=[],u=t.split(","),n=0,s=u.length;s>n;n++){for(r=[],i=u[n],e=0,l=i.length;l>e;e++)a=i.substring(e,e+1),"_"===a?a=null:(a=c.indexOf(a),-1===a&&(a=null)),r.push(a);o.push(r)}return o}(n[2]):"e"===n[1]&&(s=function(t){var n,s,e,l,r,o,u,i,a,c,h,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-.";for(i=[],a=t.split(","),s=0,e=a.length;e>s;s++){for(u=[],c=a[s],l=0,r=c.length;r>l;l+=2)n=c.substring(l,l+1),o=c.substring(l+1,l+2),"_"===n||"_"===o?h=null:(n=d.indexOf(n),o=d.indexOf(o),h=-1===n||-1===o?null:64*n+o),u.push(h);i.push(u)}return i}(n[2])),s):(e.utils.logError("No format specified for chd (data). Aborting."),void 0)},e.opts.chdl=function(t){return(t||"").split("|")},e.opts.chl=e.opts.chdl,e.opts.chs=function(t){var n,s=/^(\d+)x(\d+)$/;return null==t&&(e.utils.logError("chs (size) not specified. Using default."),t=e.defaults.chs),n=s.exec(t),n||(e.utils.logError("chs (size) formatted incorrectly. Using default."),n=s.exec(e.defaults.chs)),{height:parseInt(n[2],10),width:parseInt(n[1],10)}},e.utils=e.utils||{},e.utils.buildTable=function(t,n){var e,l,r,o,u,i,a=[],c=0;for(i=new s.visualization.DataTable,i.addColumn("string"),e=0,l=n.length;l>e;e++)i.addColumn("number"),u=n[e],a.push(u.length);for(c=Math.max.apply(null,a),r=0;c>r;r++){for(o=[t[r]],e=0,l=n.length;l>e;e++)u=n[e],o.push(u[r]);i.addRow(o)}return i},e.utils.logError=function(n,s){s=s!==void 0?s:t.document.getElementById("playfair-errors");var e=t.document.createDocumentFragment(),l=t.document.createElement("p");l.textContent=n,e.appendChild(l),s.appendChild(e)},e.utils.parseHash=function(t){var n,s,e,l,r,o={};for(t="#"===t.substring(0,1)?t.substring(1):t,r=t.split("&"),n=0,s=r.length;s>n;n++)l=r[n],e=l.split("="),o[e[0]]=e[1];return o},e.init=function(l,r){var o=e.utils.parseHash(l);s.load("visualization","1.0",{packages:["corechart"]}),s.setOnLoadCallback(function(){t.document.getElementById(r),e.opts.chs(o.chs),e.utils.buildTable(e.opts.chdl(o.chdl||o.chl),e.opts.chd),n("Loaded.")})}})(this);