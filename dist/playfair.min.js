/*! Playfair.js - v0.1.0-dev - 2013-10-16 */

(function(t){"use strict";var n=t.google||{},s=t.PF||{};t.PF=s,s.defaults=s.defaults||{},s.defaults.chs="300x200",s.opts=s.opts||{},s.opts.chd=function(t){var n,r,e=/^([tse]):(.+)$/;return(n=e.exec(t))?("t"===n[1]?r=function(t){var n,s,r,e,i,l,o,u,a,h;for(l=[],o=t.split("|"),n=0,s=o.length;s>n;n++){for(i=[],u=o[n],h=u.split(","),r=0,e=h.length;e>r;r++)a=h[r],"_"===a?a=null:(a=parseFloat(a),isNaN(a)&&(a=null)),i.push(a);l.push(i)}return l}(n[2]):"s"===n[1]?r=function(t){var n,s,r,e,i,l,o,u,a,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(l=[],o=t.split(","),n=0,s=o.length;s>n;n++){for(i=[],u=o[n],r=0,e=u.length;e>r;r++)a=u.substring(r,r+1),"_"===a?a=null:(a=h.indexOf(a),-1===a&&(a=null)),i.push(a);l.push(i)}return l}(n[2]):"e"===n[1]&&(r=function(t){var n,s,r,e,i,l,o,u,a,h,c,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-.";for(u=[],a=t.split(","),s=0,r=a.length;r>s;s++){for(o=[],h=a[s],e=0,i=h.length;i>e;e+=2)n=h.substring(e,e+1),l=h.substring(e+1,e+2),"_"===n||"_"===l?c=null:(n=p.indexOf(n),l=p.indexOf(l),c=-1===n||-1===l?null:64*n+l),o.push(c);u.push(o)}return u}(n[2])),r):(s.utils.logError("No format specified for chd (data). Aborting."),void 0)},s.opts.chdl=function(t){return(t||"").split("|")},s.opts.chl=s.opts.chdl,s.opts.chs=function(t){var n,r=/^(\d+)x(\d+)$/;return null==t&&(s.utils.logError("chs (size) not specified. Using default."),t=s.defaults.chs),n=r.exec(t),n||(s.utils.logError("chs (size) formatted incorrectly. Using default."),n=r.exec(s.defaults.chs)),{height:parseInt(n[2],10),width:parseInt(n[1],10)}},s.opts.cht=function(t){var r,e={};return"p3"===t?(r=n.visualization.PieChart,e.is3D=!0):"p"===t?r=n.visualization.PieChart:t?s.utils.logError("Unsupported cht (chart type) specified. Aborting."):s.utils.logError("No cht (chart type) specified. Aborting."),{chartClass:r,options:e}},s.utils=s.utils||{},s.utils.buildTable=function(t,s){var r,e,i,l,o,u,a=[],h=0;for(u=new n.visualization.DataTable,u.addColumn("string"),r=0,e=s.length;e>r;r++)u.addColumn("number"),o=s[r],a.push(o.length);for(h=Math.max.apply(null,a),i=0;h>i;i++){for(l=[t[i]],r=0,e=s.length;e>r;r++)o=s[r],l.push(o[i]);u.addRow(l)}return u},s.utils.logError=function(n,s){s=s!==void 0?s:t.document.getElementById("playfair-errors");var r=t.document.createDocumentFragment(),e=t.document.createElement("p");e.textContent=n,r.appendChild(e),s.appendChild(r)},s.utils.parseHash=function(t){var n,s,r,e,i,l={};for(t="#"===t.substring(0,1)?t.substring(1):t,i=t.split("&"),n=0,s=i.length;s>n;n++)e=i[n],r=e.split("="),l[r[0]]=r[1];return l},s.init=function(r,e){var i=s.utils.parseHash(r);n.load("visualization","1.0",{packages:["corechart"]}),n.setOnLoadCallback(function(){var n,r,l=t.document.getElementById(e),o=s.opts.cht(i.cht),u=s.opts.chs(i.chs),a={},h=s.utils.buildTable(s.opts.chdl(i.chdl||i.chl),s.opts.chd(i.chd));for(r in o.options)o.options.hasOwnProperty(r)&&(a[r]=o.options[r]);a.height=u.height,a.width=u.width,n=new o.chartClass(l),n.draw(h,a)})}})(this);